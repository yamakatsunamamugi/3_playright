# Google スプレッドシート設定ガイド

## 🚨 現在のエラー状況
```
❌ 403エラー: "The caller does not have permission"
```

このエラーは、サービスアカウントがスプレッドシートにアクセスする権限を持っていないことを意味します。

## 📋 解決手順（初心者向け）

### ステップ1: スプレッドシートを開く
1. Google スプレッドシートにアクセス
2. 使用したいスプレッドシートを開く

### ステップ2: サービスアカウントと共有
1. スプレッドシートの右上にある「**共有**」ボタンをクリック
2. 「ユーザーやグループを追加」欄に以下のメールアドレスを入力：
   ```
   spreadsheet-ai-service@spreadsheetai-462715.iam.gserviceaccount.com
   ```
3. 権限を「**編集者**」に設定
4. 「**送信**」をクリック

### ステップ3: シート構造の確認
スプレッドシートに以下の構造があることを確認：

1. **5行目（作業指示行）**: A列に「作業指示行」と記載
2. **コピー列**: どこかの列に「コピー」というヘッダー
3. **処理対象行**: A列に「1」「2」「3」...の連番

### ステップ4: テストスプレッドシートの例

もし新しくスプレッドシートを作成する場合の例：

| A | B | C | D | E | F |
|---|---|---|---|---|---|
| 1 |   |   |   |   |   |
| 2 |   |   |   |   |   |
| 3 |   |   |   |   |   |
| 4 |   |   |   |   |   |
| **作業指示行** | タイトル | **コピー** | 処理状況 | エラー | 結果 |
| 1 | テスト1 | これはテストです | 未処理 |   |   |
| 2 | テスト2 | AIでこれを処理してください | 未処理 |   |   |

## 🔧 トラブルシューティング

### 問題1: スプレッドシートIDがわからない
URLから抽出：
```
https://docs.google.com/spreadsheets/d/[この部分がID]/edit
```

### 問題2: 共有設定が見つからない
1. スプレッドシート右上の「共有」ボタンを探す
2. 見つからない場合は、ファイル→共有→他のユーザーと共有

### 問題3: サービスアカウントのメールアドレス
```
spreadsheet-ai-service@spreadsheetai-462715.iam.gserviceaccount.com
```

## ✅ 設定完了の確認方法

1. 共有設定でサービスアカウントが表示される
2. アプリケーションで「スプレッドシート分析」ボタンをクリック
3. 403エラーが解消される

## 📞 サポート

設定が完了したら、アプリケーションを再実行してください。
エラーが解消されない場合は、以下を確認：

1. スプレッドシートURL
2. シート名
3. サービスアカウントの共有設定